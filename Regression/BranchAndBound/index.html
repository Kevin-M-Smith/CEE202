<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Vignette: Branch and Bound</title>

<script src="index_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="index_files/bootstrap-2.3.2/css/spacelab.min.css" rel="stylesheet" />
<link href="index_files/bootstrap-2.3.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-2.3.2/js/bootstrap.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="index_files/highlight/default.css"
      type="text/css" />
<script src="index_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="container-fluid main-container">


<div id="header">
<h1 class="title">Vignette: Branch and Bound</h1>
</div>

<div id="TOC">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#the-subsetting-problem">The Subsetting Problem</a><ul>
<li><a href="#the-r2-ratchet">The <span class="math">\(R^2\)</span> Ratchet</a></li>
<li><a href="#best-subsets">Best Subsets</a></li>
</ul></li>
<li><a href="#branch-and-bound">Branch and Bound</a><ul>
<li><a href="#step-wise-example">Step-wise Example</a><ul>
<li><a href="#step-1">Step 1</a></li>
<li><a href="#step-2">Step 2</a></li>
<li><a href="#step-3">Step 3</a></li>
<li><a href="#step-4">Step 4</a></li>
<li><a href="#step-5">Step 5</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery-ui.min.js"></script>
<script type="text/javascript" src="js/jquery.fancybox-1.3.4.pack.min.js"></script>
<script type="text/javascript" src="js/jquery.tocify.js"></script>
<script type="text/javascript" src="js/jquery.scianimator.min.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script>  </script>
<link type="text/css" rel="stylesheet" href="css/jquery.tocify.css" /> <link type="text/css" rel="stylesheet" media="screen" href="css/jquery.fancybox-1.3.4.css" /> <link type="text/css" rel="stylesheet" href="css/style.css"
<head>
<div id="tableofcontents">

</div>
</head>
<div id="source" class="tocify">
<ul class="tocify-header nav nav-list">
<li class="tocify-item active" style="cursor: pointer;">
<a onclick='toggle_R();' >Show / Hide Source</a>
</li>
</ul>
</div>
<strong>Kevin M. Smith // Environmental Statistics // Fall 2014</strong>
<hr>
<pre class="r"><code>library(knitr)
library(ggplot2)
library(xtable)
library(gridExtra)
library(pander)

opts_knit$set(fig.width = 10,
              xtable.type = &#39;html&#39;,
              warning = FALSE,
              cache = TRUE,
              dev = &#39;png&#39;)


options(xtable.comment = FALSE)
panderOptions(&#39;table.split.table&#39;, Inf)</code></pre>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>The purpose of this short note is to introduce the <strong>branch and bound</strong> method for <strong>exhaustive subsetting of predictor variables in multivariate linear regression</strong>. Those familiar with integer programming may also be familiar with branch and bound techniques, as they are widely used. This note will not explore low-level algorithmic details (which vary widely) but instead convey the basic theory and general results of the application of branch and bound techniques.</p>
</div>
<div id="the-subsetting-problem" class="section level1">
<h1>The Subsetting Problem</h1>
<div id="the-r2-ratchet" class="section level2">
<h2>The <span class="math">\(R^2\)</span> Ratchet</h2>
<p>Here we are concerned with estimating the mean of the vector <span class="math">\(y = X\beta + \epsilon\)</span> where <span class="math">\(X\)</span> is a <span class="math">\(n\)</span> by <span class="math">\(p\)</span> design matrix. In general, increasing <span class="math">\(p\)</span> (the number of predictors) relative to <span class="math">\(n\)</span> (the number of observations) will reduce the residual sum of square errors, <span class="math">\(RSS = \sum_i^n (y_i - \hat{y})\)</span> and increase the coefficient of determination <span class="math">\(R^2\)</span>. In fact, <strong>RSS will never increase</strong> and <strong>the <span class="math">\(R^2\)</span> never decrease</strong> with an additional predictor <span class="math">\(X_{p+1}\)</span>, regardless of wheter or not the new predictor <span class="math">\(X_{p+1}\)</span> is a cuasal driver of <span class="math">\(y\)</span> or just random noise. <a href="http://kevin-m-smith.github.io/CEE202/Regression/TheRatchet/">See the <em>Vignette</em> on the <span class="math">\(R^2\)</span> ratchet for more details.</a></p>
</div>
<div id="best-subsets" class="section level2">
<h2>Best Subsets</h2>
<p>One method to account for the effects of the number of predictors (<span class="math">\(p\)</span>) on the in-set predictive capability is simply to enumerate the <span class="math">\(k\)</span> best models for each subset of <span class="math">\(d\)</span> predictors where <span class="math">\(d \le p\)</span> so the trade-offs can be assessed directly. However, as the number of models to evaluate grows quickly with <span class="math">\(p\)</span>, the upper bound on <span class="math">\(d\)</span>. Specifically, at each level <span class="math">\(d\)</span> there are <span class="math">\(\tbinom pd\)</span> models.</p>
<pre class="r"><code>library(ggplot2)
#p == 5
p3 &lt;- rep(&quot;3&quot;, 9)
x3 &lt;- c(1:3, rep(NA, 6))
y3 &lt;- c(choose(3, x3))

#p == 5
p5 &lt;- rep(&quot;5&quot;, 9)
x5 &lt;- c(1:5, NA, NA, NA, NA)
y5 &lt;- c(choose(5, x5))

#p == 7
p7 &lt;- rep(&quot;7&quot;, 9)
x7 &lt;- c(1:7, NA, NA)
y7 &lt;- c(choose(7, x7))

# p == 9
p9 &lt;- rep(&quot;9&quot;, 9)
x9 &lt;- 1:9
y9 &lt;- choose(9, x9)


df &lt;- data.frame(x = c(x3, x5, x7, x9), 
                 y = c(y3, y5, y7, y9), 
                 p = c(p3, p5, p7, p9))

p &lt;- ggplot(df, aes(x = x, y = y, color = p)) + 
  geom_line(lwd = 2) + scale_y_log10() + 
  scale_x_continuous(breaks = round(seq(1, 9, by = 1),0)) + 
  ggtitle(&quot;Number of Models to Evaluate at Each Subset Level (d) as a Function of Predictors (p).&quot;) + 
  ylab(&quot;Number of Models to Evaluate&quot;) +
  xlab(&quot;Subset Level (d)&quot;)

p</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (geom_path).</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" /></p>
</div>
</div>
<div id="branch-and-bound" class="section level1">
<h1>Branch and Bound</h1>
<p><strong>Furnival and Wilson</strong>,</p>
<div id="step-wise-example" class="section level2">
<h2>Step-wise Example</h2>
<div id="step-1" class="section level3">
<h3>Step 1</h3>
<p><img src="images/bb1.svg" alt="Step 1" /></p>
</div>
<div id="step-2" class="section level3">
<h3>Step 2</h3>
<p><img src="images/bb2.svg" alt="Step 2" /></p>
</div>
<div id="step-3" class="section level3">
<h3>Step 3</h3>
<p><img src="images/bb3.svg" alt="Step 3" /></p>
</div>
<div id="step-4" class="section level3">
<h3>Step 4</h3>
<p><img src="images/bb4.svg" alt="Step 4" /></p>
</div>
<div id="step-5" class="section level3">
<h3>Step 5</h3>
<p><img src="images/bb5.svg" alt="Step 5" /></p>
</div>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
